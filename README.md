# Описание
С помощью 2-х конфигураций ingress controller предоставляются 2 API серверного приложения:

1. Не требующее идентификации и аутентификации пользователя и позволяющее зарегистрировать нового пользователя в системе. Также открытыми являются апи позволяющие получить информацию о состоянии экземпляра приложения (actuator).
2. Требующее идентификацию и аутентификацию пользователя и позволяющее получить информацию только о своем аккаунте, отредактировать данные только своего аккаунта.
Идентификация и аутентификация пользователя осуществляется с помощью внешнего самописного identity provider - auth-service. После регистрации и входа в систему, пользователь получает токен от auth-service. Запросы пользователя к API сервиса user-service перенаправляются в сервис аутентификации, который верифицирует токен и отвечает на первоначальный запрос, добавляя в заголовок ответа X-Auth-Client,X-Auth-Roles. Запрос попадает на обработку в серверное приложение, которое проверяет доступы клиента по заголовкам X-Auth-Client, X-Auth-Role. Идентификация пользователя в серверном приложении выполняется с помощью email из X-Auth-Client, поэтому этот атрибут запрещен для редактирования и должен быть уникальным.

![scheme](/diagramma.PNG)

# Установка
Требования: установленный аддон ingress-nginx.
Для запуска необходимо выполнить команды:\
`helm upgrade --install auth .\charts\hw-auth\ -f .\charts\hw-auth\values.yaml`\
`helm upgrade --install usr .\charts\hw-user\ -f .\charts\hw-user\values.yaml`
